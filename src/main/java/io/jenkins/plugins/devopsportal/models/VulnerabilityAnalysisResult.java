package io.jenkins.plugins.devopsportal.models;

import java.io.Serializable;
import java.util.*;

/**
 * A record for a set of dependencies with known vulnerabilities
 *
 * @author RÃ©mi BELLO {@literal <remi@evolya.fr>}
 */
public class VulnerabilityAnalysisResult implements Serializable {

    private final Map<String, List<DependencyVulnerability>> items = new HashMap<>();

    public Map<String, List<DependencyVulnerability>> getItems() {
        return items;
    }

    public List<DependencyVulnerability> add(String fileName) {
        List<DependencyVulnerability> list = new ArrayList<>();
        items.put(fileName, list);
        return list;
    }

    public List<DependencyVulnerability> getVulnerabilitiesByDependency(String dependency) {
        if (!items.containsKey(dependency)) {
            return Collections.emptyList();
        }
        return items.get(dependency);
    }

    public List<String> getDependencies() {
        return new ArrayList<>(items.keySet());
    }

    public boolean isEmpty() {
        return items.isEmpty();
    }

    public int getDependenciesCount() {
        return items.size();
    }

    public int getVulnerabilitiesCount() {
        return items.values().stream().mapToInt(List::size).sum();
    }

}
