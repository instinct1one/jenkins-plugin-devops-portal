package io.jenkins.plugins.devopsportal.buildmanager;

import io.jenkins.plugins.devopsportal.utils.MiscUtils;

import java.io.Serializable;
import java.util.List;

/**
 * A record for a dependency with a known vulnerability
 *
 * @author RÃ©mi BELLO {@literal <remi@evolya.fr>}
 */
public class DependencyVulnerability implements Serializable {

    public final String dependency;
    public final List<String> packages;
    public final List<String> vulnerabilities;

    public DependencyVulnerability(String dependency, String packages, String vulnerabilities) {
        this.dependency = dependency;
        this.packages = MiscUtils.split(packages, ",");
        this.vulnerabilities = MiscUtils.split(vulnerabilities, ",");
    }

    public String toString() {
        return String.format("%s => %s => %s", dependency, packages, vulnerabilities);
    }

}
